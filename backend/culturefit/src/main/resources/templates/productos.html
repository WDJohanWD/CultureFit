<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos - CulturaFit</title>
    <script src="https://js.stripe.com/v3/"></script> <!-- Stripe.js -->
</head>
<body>
    <h1>Productos Disponibles</h1>
    <div>
        <div th:each="producto : ${productos}">
            <h2 th:text="${producto.name}"></h2>
            <p th:text="${producto.description}"></p>
            <button th:id="'pagar-' + ${producto.id}" onclick="pagar('${producto.id}')">Pagar</button>
        </div>
    </div>

    <script>
        var stripe = Stripe('your-publishable-key-here');  // Sustituir con tu clave pública de Stripe

        function pagar(productoId) {
            // Llama al backend para crear la sesión de pago
            fetch('/crear-sesion-pago/' + productoId, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(sessionId => {
                stripe.redirectToCheckout({ sessionId: sessionId });
            })
            .catch(error => console.error('Error al crear la sesión de pago:', error));
        }
    </script>
</body>
</html>